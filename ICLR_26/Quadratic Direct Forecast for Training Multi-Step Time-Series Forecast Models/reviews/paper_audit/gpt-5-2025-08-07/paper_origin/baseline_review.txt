Summary
- The paper addresses the design of learning objectives for multi-step direct time-series forecasting. It argues that conventional MSE treats future steps as independent and equally weighted, overlooking label autocorrelation and heterogeneous task difficulty. The authors propose a quadratic-form objective derived from Gaussian NLL, weighted by the inverse conditional covariance Σ−1 (Theorem 3.1; Eq. (2), Section 3.1). They learn a proxy Σ via a bilevel procedure that updates model parameters θ in an inner loop and Σ in an outer loop, with PSD enforced by a Cholesky reparameterization (Definition 3.2; Algorithm 1; Section 3.2). The resulting Quadratic Direct Forecast (QDF) trains models using the learned Σ (Algorithm 2; Section 3.3). Experiments across ETT, ECL, Weather, and PEMS demonstrate consistent improvements over baselines and alternative objectives (Table 1, Table 2), supported by ablation (Table 3), generalization to different architectures (Fig. 3, Fig. 8), meta-learning variants (Table 4), sensitivity (Fig. 4), and complexity (Appendix D.7; Fig. 9).Strengths
- Bold motivation grounded in empirical evidence
  • The paper diagnoses two challenges—label autocorrelation and heterogeneous task weights—with concrete measurements: substantial off-diagonal partial correlations and non-uniform conditional variances (Fig. 1(a); Section 3.1). This matters because it justifies why point-wise losses like MSE (Eq. (1), Section 2.3) can be biased and motivates a structured objective.  
  • The comparison of transformed components from FreDF and Time-o1 shows residual autocorrelation (Fig. 1(b); Appendix A, Fig. 5), supporting the claim that prior decorrelation approaches do not ensure conditional decorrelation. This matters for novelty in the loss design focus.  
  • The case study clearly links these diagnostics to the proposed solution (Section 3.1), improving narrative clarity and problem framing.- Clear probabilistic formulation of the objective
  • The quadratic objective follows directly from Gaussian NLL (Theorem 3.1; Eq. (2), Section 3.1; Appendix B), giving a principled foundation for the weighting matrix Σ−1. This matters for technical soundness.  
  • Explicitly associating off-diagonal entries with autocorrelation and diagonal entries with task-specific weights (Section 3.1; Section 3.3) increases interpretability and impact.  
  • The reparameterization via Cholesky to enforce Σ ⪰ 0 (Section 3.2) addresses a key constraint and aids stable optimization.- Bilevel learning strategy for Σ with practical algorithms
  • The bilevel formulation to target out-of-sample generalization (Definition 3.2; Eq. (3), Section 3.2) is a reasonable design choice that matters for performance.  
  • Algorithm 1 and Algorithm 2 provide concrete training procedures, including chronological K-way splitting for robustness (Algorithm 2; Section 3.3). This matters for reproducibility and clarity.  
  • The workflow emphasizes no test leakage (Section 3.3), which is impactful for fair evaluation.- Comprehensive experimental evaluation
  • Overall performance shows consistent gains across datasets on MSE and MAE (Table 1; Section 4.2). This matters for empirical rigor and impact.  
  • Comparisons with alternative objectives (Time-o1, FreDF, Koopman, Soft-DTW) demonstrate QDF’s superiority in most settings (Table 2; Section 4.3; Table 7 in Appendix D). This matters for positioning relative to literature.  
  • Ablations isolate heterogeneous weights (QDF†) and autocorrelation (QDF‡) contributions, with the full QDF performing best (Table 3; Section 4.4), which matters for technical soundness.  
  • Generalization across architectures (TQNet, PDF, FedFormer, iTransformer) with percentage error reductions (Fig. 3; Fig. 8; Section 4.5) supports versatility and impact.  
  • Meta-learning variants outperform DF and QDF performs best (Table 4; Section 4.6), highlighting flexibility.  
  • Sensitivity to N_in, K, and η is explored (Fig. 4; Section 4.7), and seed robustness is reported (Table 9; Appendix D.6), strengthening experimental rigor.- Practical considerations and efficiency
  • The claim that QDF adds no inference-time overhead and modest training overhead is supported by timing plots across horizons (Appendix D.7; Fig. 9). This matters for practical adoption.  
  • The Reproducibility Statement and code link (Appendix E; Appendix Reproducibility Statement) and implementation details (Appendix C.2) improve replicability and clarity.Weaknesses
- Limited theoretical guarantees for the learned Σ and bias correction
  • Theorem 3.1 (Eq. (2); Appendix B) restates standard Gaussian NLL; there is no formal analysis showing that the proxy Σ learned via the bilevel procedure consistently reduces estimation bias or converges to the conditional covariance structure. No direct evidence found in the manuscript. This matters for novelty and technical strength.  
  • Section 3.2 states the goal is to learn Σ “targeting generalization” (Definition 3.2), but provides no convergence or generalization bound for the procedure or its hypergradient approximation. No direct evidence found in the manuscript. This matters for technical rigor.  
  • The bias critique of MSE (Section 2.3; 3.1) is valid empirically, but the paper lacks a formal demonstration that QDF’s learned Σ−1 objectively corrects that bias in a statistical sense across datasets. No direct evidence found in the manuscript. This matters for theoretical soundness.- Ambiguity about hypergradient computation in the bilevel update
  • Section 3.2 claims “the outer loop gradient is taken through the model parameter θ to Σ,” yet Algorithm 1 Step 7 implements Σ ← Σ − η ∇_Σ L_Σ(X_out, Y_out; g_θ), which appears to treat θ as fixed and does not explicitly unroll or differentiate through inner updates. This mismatch matters for correctness.  
  • Algorithm 2 repeatedly applies Algorithm 1 across splits (Steps 2–5) but still does not describe hypergradient computation through N_in inner steps; Appendix C.2 does not specify hypergradient implementation. No direct evidence found in the manuscript. This matters for reproducibility and technical clarity.  
  • Without explicit hypergradient details (e.g., implicit differentiation or unrolled backprop through inner updates), the bilevel optimization may reduce to a simpler bi-stage procedure that does not optimize for generalization via θ’s dependence on Σ. This matters for claimed advantages.- Restrictive treatment of multivariate forecasting
  • Section 2.1 footnote: “In the multivariate case, each variable can be treated as a separate univariate case when computing the learning objectives.” This ignores cross-variable label covariance, so Σ is T×T rather than (T·D)×(T·D). This matters for modeling fidelity in multivariate datasets (e.g., ECL, Weather; Appendix C.1; Table 5).  
  • Eq. (2) and Theorem 3.1 are written for Y ∈ R^T, consistent with the univariate assumption; there is no extension to jointly weighted multivariate sequences. This matters for generality and impact.  
  • Experiments include multivariate datasets (Table 1; Table 5), but the paper does not analyze the potential performance gap from ignoring inter-variable correlations or test a multivariate Σ formulation. No direct evidence found in the manuscript. This affects completeness.- Evaluation scope and fairness of SOTA claims
  • Table 1 reports QDF with TQNet as the underlying model while other baselines use their own architectures; this mixes architecture improvements with objective changes. Although Section 4.5 shows gains for several models (Fig. 3, Fig. 8), Table 1’s SOTA claim is not a fully apples-to-apples comparison. This matters for fairness.  
  • Generalization studies do not include all baselines (e.g., DLinear, TiDE, TimesNet, MICN; Table 1), and the extent of improvement across simpler linear or CNN models is not fully documented in the main text. No direct evidence found in the manuscript. This limits generality.  
  • PatchTST’s dependence on longer histories is acknowledged (Appendix D.5; Table 8), but other models that require different settings are not exhaustively covered; input length is fixed to 96 for core results (Table 1; Section 4.1). This matters for comprehensive benchmarking.- Efficiency claims lack critical details
  • The timing results (Appendix D.7; Fig. 9) show sub-2 ms overhead up to T=720, but the paper does not report hardware, batch size, precision, or implementation specifics, making the claims hard to verify. No direct evidence found in the manuscript. This affects credibility.  
  • Memory complexity of storing and inverting Σ (or solving with Σ via Cholesky) scales at least quadratically in T; the paper does not quantify memory usage or report peak RAM during training. No direct evidence found in the manuscript. This matters for practical deployment.  
  • The statement “no additional complexity to model inference” (Appendix D.7) is plausible since Σ is learned offline, but training-time overhead relative to DF baselines is not quantified beyond the curves. No direct evidence found in the manuscript. This limits practical clarity.- Case-study estimation may underrepresent nonlinear autocorrelation and uses reduced data
  • Appendix A estimates partial correlations via OLS residuals, which capture linear dependencies; nonlinear relationships may persist and affect Σ. No direct evidence found in the manuscript for nonlinear controls. This matters for completeness.  
  • The case study subsamples 5,000 examples, limits H to 8, and T to 96 (Appendix A), which reduces computational cost but potentially biases the estimated statistics relative to training settings. This matters for external validity.  
  • The reported statistic “over 61.4% exceeding 0.1” (Fig. 1(a)) lacks hypothesis testing or CI for significance; robustness across datasets is shown qualitatively (Appendix A; Fig. 5), but not quantified. This matters for statistical rigor.- Numerical stability and implementation details of Σ−1
  • The objective requires Σ−1 (Eq. (2); Section 3.1). While Σ = LLᵀ ensures PSD (Section 3.2), the paper does not specify whether gradients are computed by explicitly inverting Σ, solving triangular systems, or using stabilization (e.g., adding εI). No direct evidence found in the manuscript. This matters for stability.  
  • Softplus on L’s diagonal is mentioned (Section 3.2), but no regularization (e.g., conditioning penalties or spectral bounds) is reported to prevent ill-conditioning. No direct evidence found in the manuscript. This affects robustness.  
  • The outer-loop update (Algorithm 1 Step 7) gives a direct gradient on Σ; without explicit constraints beyond PSD reparameterization, Σ could drift to poorly conditioned matrices. No direct evidence found in the manuscript. This matters for technical quality.Suggestions for Improvement
- Strengthen theoretical analysis of the learned Σ and its relation to bias correction
  • Provide formal results or bounds showing that optimizing (Definition 3.2; Eq. (3)) reduces estimation bias relative to MSE/MAE, ideally under assumptions on the data-generating process (Section 3.1; Appendix B).  
  • Establish a convergence analysis for the bilevel procedure (Algorithm 1/2), clarifying conditions under which the proxy Σ approximates the conditional covariance or yields generalization gains.  
  • Include a controlled synthetic study where the ground-truth Σ is known to quantify how well the learned Σ recovers autocorrelation structure and heterogeneous variances (anchoring to Eq. (2) and Section 4.4’s ablations).- Clarify and implement hypergradient computation in the bilevel update
  • Explicitly unroll inner updates and show how the outer gradient ∇Σ incorporates the dependence of θ* on Σ (e.g., through backpropagation through optimization or implicit differentiation), aligning the text in Section 3.2 with Algorithm 1 Step 7.  
  • Document the exact hypergradient method used (number of unrolled steps, memory trade-offs) in Appendix C.2 and update Algorithm 1 to reflect it (e.g., notation for θ*(Σ) and hypergradient paths).  
  • Provide an ablation comparing: (i) direct gradient w.r.t. Σ with θ fixed, vs (ii) hypergradient through inner updates, and report generalization performance on a holdout split (Section 4.7; Fig. 4).- Extend QDF to multivariate weighting or discuss its limitations more thoroughly
  • Consider a block-structured Σ over (T·D)×(T·D) that models both temporal and cross-variable correlations, or justify the univariate approximation with empirical tests on multivariate datasets (Section 2.1 footnote; Table 5; Table 1).  
  • Add experiments comparing univariate Σ (current) vs multivariate Σ on ECL and Weather, quantifying gains and computational trade-offs (Section 4.5; Fig. 3).  
  • If multivariate Σ is infeasible at scale, discuss structured parameterizations (e.g., Kronecker or low-rank forms) and report complexity/memory (Appendix D.7).- Broaden and align evaluation to isolate objective-level improvements
  • Complement Table 1 with QDF integrated into more baselines (e.g., DLinear, TiDE, TimesNet, MICN), reporting consistent training protocols and the same input history length (Section 4.1), to make SOTA claims attributable to the objective.  
  • Expand Section 4.5/Fig. 8 to include these models with 95% confidence intervals or multiple seeds (Appendix D.6), clarifying robustness.  
  • Explore model-specific preferred history lengths (beyond PatchTST; Appendix D.5; Table 8) to ensure comparisons are fair across architectures and settings.- Report detailed efficiency and resource metrics
  • Include hardware details (GPU/CPU model, RAM, batch size, precision, framework) and precise timing methodology for Fig. 9 in Appendix D.7.  
  • Quantify memory usage for storing Σ and its gradients, and discuss whether solving with Σ−1 uses explicit inversion or triangular solves; provide per-epoch overhead relative to DF.  
  • Add scaling plots in Appendix D.7 showing training time vs T for several batch sizes and architectures and a breakdown of inner vs outer loop time (Algorithm 1 Steps 4 and 7).- Strengthen the autocorrelation case study with nonlinear controls and full-scale data
  • Augment Appendix A with nonlinear partial correlation estimates (e.g., kernel-based residualization) and compare to OLS residuals, to assess sensitivity to nonlinearity.  
  • Re-estimate partial correlations on full training settings (larger H and actual dataset sizes), or provide sub-sampling robustness checks demonstrating stability of the observed patterns.  
  • Report statistical significance (e.g., bootstrapped CIs or hypothesis tests) for the “61.4% exceeding 0.1” figure (Fig. 1(a)) and summarize across datasets (Appendix A; Fig. 5) with quantitative metrics.- Provide numerical stability details for handling Σ−1
  • Document how Σ−1 is computed in practice (explicit inversion vs solves with L), and whether an εI term is added for conditioning; include this in Appendix C.2.  
  • Consider regularizers (e.g., Frobenius norm on off-diagonals, spectral constraints, trace penalties) to prevent ill-conditioning and report their effect in ablations (Section 4.4; Table 3).  
  • Monitor and report the condition number of Σ during training and ensure PSD is preserved via reparameterization (Section 3.2), adding diagnostics in Appendix D.Score
- Overall (10): 7 — Strong empirical results across datasets with clear motivation and practical algorithms (Table 1; Table 2; Table 3; Fig. 3; Fig. 4), but limited theoretical guarantees and some methodological ambiguities (Section 3.2; Algorithm 1).
- Novelty (10): 6 — The idea of learning a quadratic weighting matrix for DF is useful, but the core objective follows standard Gaussian NLL (Theorem 3.1; Appendix B) and the meta-learning connection is conceptual (Section 3.3); novelty lies mainly in the bilevel learning of Σ and its application.
- Technical Quality (10): 6 — Sound formulation and careful experiments (Table 1–4; Fig. 3–4; Appendix D), but missing hypergradient details (Section 3.2; Algorithm 1), multivariate treatment (Section 2.1 footnote), and stability/efficiency specifics (Appendix D.7).
- Clarity (10): 8 — The manuscript is generally clear with algorithms and extensive results (Algorithm 1–2; Section 4; Appendix C–D), though some critical implementation details (hypergradients, Σ−1 computation) need clarification (Section 3.2; Appendix C.2).
- Confidence (5): 4 — High confidence in reading and interpretation based on detailed anchors across methodology and experiments; some reservations due to missing theoretical and implementation specifics (Section 3.2; Appendix D.7).